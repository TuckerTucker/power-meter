{
  "metadata": {
    "agent": "secrets-detector",
    "version": "1.0.0",
    "execution_time": "45s",
    "scan_scope": [
      "*.go",
      "Makefile",
      "README.md",
      "License.txt",
      ".gitignore",
      "doc/",
      "config files",
      "environment files"
    ],
    "analysis_date": "2025-07-26T10:30:00Z",
    "repository": "power-meter",
    "scan_methodology": [
      "regex_pattern_matching",
      "base64_detection",
      "api_key_patterns",
      "database_connection_strings",
      "private_key_detection",
      "jwt_token_analysis",
      "oauth_credential_scanning",
      "hardcoded_credential_detection"
    ]
  },
  "summary": {
    "total_secrets": 1,
    "critical_secrets": 0,
    "high_secrets": 0,
    "medium_secrets": 1,
    "low_secrets": 0,
    "score": 8.5,
    "scan_status": "complete",
    "false_positive_rate": "low"
  },
  "findings": [
    {
      "id": "SEC-001",
      "title": "Insecure Network Binding Configuration",
      "severity": "medium",
      "category": "network_security",
      "description": "Application binds to all network interfaces (0.0.0.0) without authentication",
      "location": {
        "file": "/Volumes/tkr-riffic/@tkr-projects/power-meter/power-meter.go",
        "line": 15,
        "column": 1
      },
      "evidence": "LISTEN_HOST = \"0.0.0.0\" // tcp interface to serve counter on",
      "impact": "Exposes power meter data to all network interfaces without authentication or encryption",
      "remediation": "Consider binding to localhost (127.0.0.1) or implement authentication/authorization controls",
      "effort": "low",
      "secret_type": "network_configuration",
      "confidence": "high",
      "cwe_id": "CWE-200",
      "owasp_category": "A01:2021-Broken Access Control"
    }
  ],
  "security_analysis": {
    "credentials_found": {
      "api_keys": 0,
      "database_passwords": 0,
      "private_keys": 0,
      "jwt_secrets": 0,
      "oauth_tokens": 0,
      "session_secrets": 0,
      "environment_variables": 0
    },
    "patterns_checked": [
      "AWS access keys (AKIA*)",
      "GitHub tokens",
      "Google API keys",
      "Database connection strings",
      "JWT tokens and secrets",
      "Private keys (RSA, EC)",
      "OAuth tokens",
      "Base64 encoded secrets",
      "Hardcoded passwords"
    ],
    "files_analyzed": 5,
    "lines_scanned": 111,
    "excluded_files": [
      "_project/**/*",
      ".claude/**/*"
    ]
  },
  "recommendations": [
    {
      "priority": "medium",
      "category": "network_security",
      "description": "Implement network access controls",
      "actions": [
        "Change LISTEN_HOST to '127.0.0.1' for localhost-only access",
        "Implement authentication mechanism before exposing to network",
        "Consider using HTTPS/TLS for encrypted communication",
        "Add firewall rules to restrict access to specific IPs"
      ]
    },
    {
      "priority": "low",
      "category": "monitoring",
      "description": "Implement secrets monitoring",
      "actions": [
        "Set up pre-commit hooks to scan for secrets",
        "Implement secret scanning in CI/CD pipeline",
        "Use environment variables for any future configuration",
        "Document secure deployment practices"
      ]
    }
  ],
  "best_practices": {
    "current_status": "good",
    "positive_findings": [
      "No hardcoded API keys found",
      "No database credentials in source code",
      "No private keys or certificates exposed",
      "No JWT secrets or OAuth tokens hardcoded",
      "Clean codebase with minimal configuration"
    ],
    "areas_for_improvement": [
      "Network binding configuration security",
      "Authentication implementation",
      "Secure communication protocols"
    ]
  },
  "compliance": {
    "gdpr": "partial",
    "pci_dss": "not_applicable",
    "hipaa": "not_applicable",
    "sox": "not_applicable",
    "notes": "No personal data handling detected, but network security considerations apply"
  }
}